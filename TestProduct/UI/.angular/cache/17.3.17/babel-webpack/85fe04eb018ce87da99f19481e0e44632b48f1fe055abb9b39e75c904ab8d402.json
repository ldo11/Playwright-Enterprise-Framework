{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatToolbarModule } from '@angular/material/toolbar';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatDialog, MatDialogModule } from '@angular/material/dialog';\nimport { MatSnackBar, MatSnackBarModule } from '@angular/material/snack-bar';\nimport { ClientFormComponent } from '../client-form/client-form.component';\nimport { ClientService } from '../../services/client.service';\nlet ClientListComponent = class ClientListComponent {\n  constructor() {\n    this.clientService = inject(ClientService);\n    this.dialog = inject(MatDialog);\n    this.snack = inject(MatSnackBar);\n    this.displayedColumns = ['firstName', 'lastName', 'dob', 'sex'];\n    this.clients = [];\n    this.trackByIndex = index => index;\n  }\n  ngOnInit() {\n    this.load();\n  }\n  getRole() {\n    const token = localStorage.getItem('token');\n    if (!token) return 'User';\n    try {\n      const payload = JSON.parse(atob(token.split('.')[1].replace(/-/g, '+').replace(/_/g, '/')));\n      const role = payload?.role || payload?.roles?.[0] || 'User';\n      return role.toLowerCase() === 'admin' ? 'Admin' : 'User';\n    } catch {\n      return 'User';\n    }\n  }\n  load() {\n    const isAdmin = this.getRole() === 'Admin';\n    this.clientService.getClients({\n      mine: !isAdmin\n    }).subscribe({\n      next: data => this.clients = data ?? [],\n      error: err => {\n        console.error(err);\n        this.snack.open('Failed to load clients', 'Dismiss', {\n          duration: 3000\n        });\n      }\n    });\n  }\n  openAddDialog() {\n    const ref = this.dialog.open(ClientFormComponent, {\n      width: '480px'\n    });\n    ref.afterClosed().subscribe(saved => {\n      if (saved) this.load();\n    });\n  }\n};\nClientListComponent = __decorate([Component({\n  selector: 'app-client-list',\n  standalone: true,\n  imports: [CommonModule, MatTableModule, MatToolbarModule, MatButtonModule, MatIconModule, MatDialogModule, MatSnackBarModule],\n  template: `\n  <mat-toolbar color=\"primary\">\n    <span>Dashboard</span>\n    <span class=\"spacer\"></span>\n    <button mat-raised-button color=\"accent\" (click)=\"openAddDialog()\"><mat-icon>add</mat-icon> Add Client</button>\n  </mat-toolbar>\n\n  <div class=\"table-container\">\n    <table mat-table [dataSource]=\"clients\" class=\"mat-elevation-z2\">\n\n      <ng-container matColumnDef=\"firstName\">\n        <th mat-header-cell *matHeaderCellDef> First Name </th>\n        <td mat-cell *matCellDef=\"let c\"> {{ c.firstName }} </td>\n      </ng-container>\n\n      <ng-container matColumnDef=\"lastName\">\n        <th mat-header-cell *matHeaderCellDef> Last Name </th>\n        <td mat-cell *matCellDef=\"let c\"> {{ c.lastName }} </td>\n      </ng-container>\n\n      <ng-container matColumnDef=\"dob\">\n        <th mat-header-cell *matHeaderCellDef> DOB </th>\n        <td mat-cell *matCellDef=\"let c\"> {{ c.dob | date:'yyyy-MM-dd' }} </td>\n      </ng-container>\n\n      <ng-container matColumnDef=\"sex\">\n        <th mat-header-cell *matHeaderCellDef> Sex </th>\n        <td mat-cell *matCellDef=\"let c\"> {{ c.sex }} </td>\n      </ng-container>\n\n      <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n      <tr mat-row *matRowDef=\"let row; columns: displayedColumns; trackBy: trackByIndex\"></tr>\n    </table>\n  </div>\n  `,\n  styles: [`\n    .spacer { flex: 1 1 auto; }\n    .table-container { padding: 16px; overflow: auto; }\n    table { width: 100%; }\n  `]\n})], ClientListComponent);\nexport { ClientListComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}