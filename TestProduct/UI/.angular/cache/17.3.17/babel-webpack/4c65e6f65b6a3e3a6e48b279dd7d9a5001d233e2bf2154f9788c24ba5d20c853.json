{"ast":null,"code":"import { inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatToolbarModule } from '@angular/material/toolbar';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatDialog, MatDialogModule } from '@angular/material/dialog';\nimport { MatSnackBar, MatSnackBarModule } from '@angular/material/snack-bar';\nimport { ClientFormComponent } from '../client-form/client-form.component';\nimport { ClientService } from '../../services/client.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/material/table\";\nimport * as i3 from \"@angular/material/toolbar\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/material/icon\";\nfunction ClientListComponent_th_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 13);\n    i0.ɵɵtext(1, \" First Name \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientListComponent_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r1 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", c_r1.firstName, \" \");\n  }\n}\nfunction ClientListComponent_th_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 13);\n    i0.ɵɵtext(1, \" Last Name \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientListComponent_td_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r2 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", c_r2.lastName, \" \");\n  }\n}\nfunction ClientListComponent_th_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 13);\n    i0.ɵɵtext(1, \" DOB \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientListComponent_td_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r3 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, c_r3.dob, \"yyyy-MM-dd\"), \" \");\n  }\n}\nfunction ClientListComponent_th_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 13);\n    i0.ɵɵtext(1, \" Sex \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientListComponent_td_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", c_r4.sex, \" \");\n  }\n}\nfunction ClientListComponent_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 15);\n  }\n}\nfunction ClientListComponent_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 16);\n  }\n}\nexport let ClientListComponent = /*#__PURE__*/(() => {\n  class ClientListComponent {\n    constructor() {\n      this.clientService = inject(ClientService);\n      this.dialog = inject(MatDialog);\n      this.snack = inject(MatSnackBar);\n      this.displayedColumns = ['firstName', 'lastName', 'dob', 'sex'];\n      this.clients = [];\n      this.trackByIndex = index => index;\n    }\n    ngOnInit() {\n      this.load();\n    }\n    getRole() {\n      const token = localStorage.getItem('token');\n      if (!token) return 'User';\n      try {\n        const payload = JSON.parse(atob(token.split('.')[1].replace(/-/g, '+').replace(/_/g, '/')));\n        const role = payload?.role || payload?.roles?.[0] || 'User';\n        return role.toLowerCase() === 'admin' ? 'Admin' : 'User';\n      } catch {\n        return 'User';\n      }\n    }\n    load() {\n      const isAdmin = this.getRole() === 'Admin';\n      this.clientService.getClients({\n        mine: !isAdmin\n      }).subscribe({\n        next: data => this.clients = data ?? [],\n        error: err => {\n          console.error(err);\n          this.snack.open('Failed to load clients', 'Dismiss', {\n            duration: 3000\n          });\n        }\n      });\n    }\n    openAddDialog() {\n      const ref = this.dialog.open(ClientFormComponent, {\n        width: '480px'\n      });\n      ref.afterClosed().subscribe(saved => {\n        if (saved) this.load();\n      });\n    }\n    static {\n      this.ɵfac = function ClientListComponent_Factory(t) {\n        return new (t || ClientListComponent)();\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ClientListComponent,\n        selectors: [[\"app-client-list\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 24,\n        vars: 4,\n        consts: [[\"color\", \"primary\"], [1, \"spacer\"], [\"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"click\"], [1, \"table-container\"], [\"mat-table\", \"\", 1, \"mat-elevation-z2\", 3, \"dataSource\"], [\"matColumnDef\", \"firstName\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"lastName\"], [\"matColumnDef\", \"dob\"], [\"matColumnDef\", \"sex\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\", \"matRowDefTrackBy\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]],\n        template: function ClientListComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"mat-toolbar\", 0)(1, \"span\");\n            i0.ɵɵtext(2, \"Dashboard\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(3, \"span\", 1);\n            i0.ɵɵelementStart(4, \"button\", 2);\n            i0.ɵɵlistener(\"click\", function ClientListComponent_Template_button_click_4_listener() {\n              return ctx.openAddDialog();\n            });\n            i0.ɵɵelementStart(5, \"mat-icon\");\n            i0.ɵɵtext(6, \"add\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(7, \" Add Client\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(8, \"div\", 3)(9, \"table\", 4);\n            i0.ɵɵelementContainerStart(10, 5);\n            i0.ɵɵtemplate(11, ClientListComponent_th_11_Template, 2, 0, \"th\", 6)(12, ClientListComponent_td_12_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(13, 8);\n            i0.ɵɵtemplate(14, ClientListComponent_th_14_Template, 2, 0, \"th\", 6)(15, ClientListComponent_td_15_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(16, 9);\n            i0.ɵɵtemplate(17, ClientListComponent_th_17_Template, 2, 0, \"th\", 6)(18, ClientListComponent_td_18_Template, 3, 4, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(19, 10);\n            i0.ɵɵtemplate(20, ClientListComponent_th_20_Template, 2, 0, \"th\", 6)(21, ClientListComponent_td_21_Template, 2, 1, \"td\", 7);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵtemplate(22, ClientListComponent_tr_22_Template, 1, 0, \"tr\", 11)(23, ClientListComponent_tr_23_Template, 1, 0, \"tr\", 12);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"dataSource\", ctx.clients);\n            i0.ɵɵadvance(13);\n            i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns)(\"matRowDefTrackBy\", ctx.trackByIndex);\n          }\n        },\n        dependencies: [CommonModule, i1.DatePipe, MatTableModule, i2.MatTable, i2.MatHeaderCellDef, i2.MatHeaderRowDef, i2.MatColumnDef, i2.MatCellDef, i2.MatRowDef, i2.MatHeaderCell, i2.MatCell, i2.MatHeaderRow, i2.MatRow, MatToolbarModule, i3.MatToolbar, MatButtonModule, i4.MatButton, MatIconModule, i5.MatIcon, MatDialogModule, MatSnackBarModule],\n        styles: [\".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.table-container[_ngcontent-%COMP%]{padding:16px;overflow:auto}table[_ngcontent-%COMP%]{width:100%}\"]\n      });\n    }\n  }\n  return ClientListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}